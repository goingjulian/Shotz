(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){e.exports=n.p+"static/media/shot.c66f8312.png"},25:function(e,t,n){e.exports=n(42)},34:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(20),c=n.n(o),s=n(3);n(34);var u=s.b(function(e){return{activeView:e.views.activeView}})(function(e){return a.a.createElement(e.activeView,null)}),i=n(1),l=n.n(i),m=n(9),d={API_URL:"http://localhost:3000",WS_URL:"ws://localhost:3000"},p={VIEW_LOGINSCREEN:1,VIEW_GAMESCREEN:2,VIEW_SCORESCREEN:3},E={REGISTER:"REGISTER",CATEGORY_SELECT:"CATEGORY_SELECT",IN_ROUND:"IN_ROUND",END_ROUND:"END_ROUND",END_GAME:"END_GAME",SUBMIT_CLOSED:"SUBMIT_CLOSED"};function v(){return{type:p.VIEW_LOGINSCREEN}}function h(){return{type:p.VIEW_GAMESCREEN}}function f(){return{type:p.VIEW_SCORESCREEN}}function g(e){return function(t){switch(e){case E.REGISTER:case E.CATEGORY_SELECT:case E.IN_ROUND:t(h());break;case E.END_ROUND:t(f());break;case E.SUBMIT_CLOSED:t(h());break;default:t(v())}}}var w=0;function _(){return console.log("WS: Connecting to websocket"),function(){var e=Object(m.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new WebSocket("".concat(d.WS_URL,"/ws"));case 2:(n=e.sent).onopen=function(){console.log("WS: Websocket connected"),w=0},n.onmessage=function(e){var n,r=JSON.parse(e.data);t((n=r,function(e){switch(n.type){case"scoreB_team_accepted":case"scoreB_team_rejected":case"scoreB_teamLeft":e((u=F.getState().game.roomKey,function(){var e=Object(m.a)(l.a.mark(function e(t){var n,r,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"GET",credentials:"include"},e.next=3,fetch("".concat(d.API_URL,"/room/").concat(u,"/teams?accepted=true"),n);case 3:if((r=e.sent).ok){e.next=6;break}throw new Error("Error while fetching teams");case 6:return e.next=8,r.json();case 8:a=e.sent,t((o=a,{type:R.scoreB_setTeams,teams:o}));case 10:case"end":return e.stop()}var o},e)}));return function(t){return e.apply(this,arguments)}}()));break;case"scoreB_selectingCategories":e({type:R.scoreB_selecting_categories}),e(h());break;case"scoreB_endRound":e(function(e){return function(){var t=Object(m.a)(l.a.mark(function t(n){var r,a,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={method:"GET",credentials:"include"},t.next=4,fetch("".concat(d.API_URL,"/room/").concat(e,"/teams/scores"),r);case 4:return a=t.sent,t.next=7,a.json();case 7:if(o=t.sent,a.ok){t.next=12;break}throw new Error(o.error);case 12:n((c=o,{type:R.scoreB_setScores,scores:c})),n(f()),n({type:R.scoreB_incCurRound});case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.log(t.t0.message);case 20:case"end":return t.stop()}var c},t,null,[[0,17]])}));return function(e){return t.apply(this,arguments)}}()}(F.getState().game.roomKey));break;case"scoreB_nextQuestion":e((c=n.currentQuestionIndex,s=n.currentQuestion,{type:R.scoreB_nextQuestion,currentQuestionIndex:c,currentQuestion:s})),e(h());break;case"scoreB_answerQuestion":e((r=n.teamId,a=n.questionId,o=n.correct,{type:R.scoreB_setQuestionStatus,teamId:r,questionId:a,correct:o}));break;case"scoreB_quizmasterLeft":e(f()),e((t=n.scores.teams,{type:R.scoreB_endGame,scores:t}));break;case"scoreB_revealAnswer":e({type:R.scoreB_revealAnswer});break;default:console.log("Unknown message: ",n)}var t,r,a,o,c,s,u}))},n.onclose=function(){w<3&&F.getState().views.wsAllowed?(console.log("WS: Trying to reconnect websocket"),w++,setTimeout(function(){t(_())},5e3)):console.log("WS: Websocket connection could not be restored")};case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}var R={scoreB_setRoom:"scoreB_setRoom",scoreB_nextQuestion:"scoreB_nextQuestion",scoreB_setScores:"scoreB_setScores",scoreB_setTeams:"scoreB_setTeams",scoreB_endGame:"scoreB_endGame",scoreB_selecting_categories:"scoreB_selecting_categories",scoreB_incCurRound:"scoreB_incCurRound",scoreB_revealAnswer:"scoreB_revealAnswer",scoreB_setQuestionStatus:"scoreB_setQuestionStatus"};function b(e,t,n,r,a){return{type:R.scoreB_setRoom,roomKey:e,gameState:t,currentRound:n,currentQuestionIndex:r,teams:a}}function S(e){var t={method:"POST",credentials:"include"};return function(){var n=Object(m.a)(l.a.mark(function n(r){var a,o;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("".concat(d.API_URL,"/room/scoreboard/").concat(e),t);case 3:return a=n.sent,n.next=6,a.json();case 6:if(o=n.sent,a.ok){n.next=9;break}throw new Error(o.error);case 9:r(b(o.roomKey,o.gameState,o.currentRound,o.currentQuestionIndex,o.teams)),r(h()),r(_()),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(0),console.log(n.t0.message);case 17:case"end":return n.stop()}},n,null,[[0,14]])}));return function(e){return n.apply(this,arguments)}}()}var y=n(22),O=n(10),x=n(2),N=n(14),I=n(4),k=n(5),B=n(7),j=n(6),C=n(8),A=(n(37),function(e){function t(e){var n;return Object(I.a)(this,t),(n=Object(B.a)(this,Object(j.a)(t).call(this,e))).state={roomKey:"",teamName:""},n}return Object(C.a)(t,e),Object(k.a)(t,[{key:"handleInput",value:function(e){var t=e.target,n=t.value,r=t.name;this.setState(Object(N.a)({},r,n))}},{key:"submitForm",value:function(e){e.preventDefault(),""===this.state.roomKey||this.props.joinRoom(this.state.roomKey)}},{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"Login"},a.a.createElement("header",null,a.a.createElement("h1",null,"Shotz: scoreboard")),a.a.createElement("main",null,a.a.createElement("div",{className:"inputField"},a.a.createElement("label",{htmlFor:"roomKey"},"Room code:"),a.a.createElement("input",{value:this.state.roomKey,onChange:function(t){return e.handleInput(t)},id:"roomKey",name:"roomKey",placeholder:"Room code",autoComplete:"off"})),a.a.createElement("div",{className:"inputField"},a.a.createElement("button",{onClick:function(t){return e.submitForm(t)}},"Join quizz"))))}}]),t}(a.a.Component));var T=s.b(function(e){return{}},function(e){return{joinRoom:function(t){return e(S(t))}}})(A);n(38),n(39);function Q(e){return a.a.createElement("div",{className:e.itemClass+" Item"},void 0!==e.index&&a.a.createElement("span",{className:"itemIndex"},e.index,"."),void 0!==e.text&&a.a.createElement("div",{className:"itemTextHolder"},a.a.createElement("span",{className:"itemText"},e.text),void 0!==e.team&&a.a.createElement("span",{className:"itemTeam"},e.team)),a.a.createElement("div",{className:"itemButtonsHolder"},void 0!==e.acceptHandler&&a.a.createElement("span",{className:"itemButtonHolder"},a.a.createElement("button",{className:"itemButton__accept",onClick:e.acceptHandler},a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},a.a.createElement("path",{d:"M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"})))),void 0!==e.closeHandler&&a.a.createElement("span",{className:"itemButtonHolder"},a.a.createElement("button",{className:"itemButton__close",onClick:e.closeHandler},a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},a.a.createElement("path",{d:"M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"}))))))}var L=n(23),G=n.n(L),K=function(e){function t(){return Object(I.a)(this,t),Object(B.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(k.a)(t,[{key:"render",value:function(){var e,t;switch(this.props.gameState){case E.REGISTER:e="Waiting for players...",t="Join with key: ".concat(this.props.roomKey);break;case E.CATEGORY_SELECT:e="The quizmaster is starting a new round",t="Selecting categories...";break;case E.IN_ROUND:case E.SUBMIT_CLOSED:var n=this.getInRoundMessages();e=n.mainMessage,t=n.subMessage;break;default:e="Oops, something went wrong",t="Error occured"}return a.a.createElement("div",{className:"question"},a.a.createElement("h2",null,t),a.a.createElement("h1",null,e))}},{key:"getInRoundMessages",value:function(){var e,t;return this.props.shotzTime?(e=a.a.createElement("div",null,"Shotz!",a.a.createElement("img",{src:G.a,alt:"A Shot Glass"})),t="".concat(this.props.shotzTime.shotzTeam," must all take a shot")):this.props.revealAnswer?(e="The correct answer is: ".concat(this.props.currentQuestion.answer),t="Did you guess the right answer?"):this.props.currentQuestion?(e=this.props.currentQuestion.question,t=this.props.currentQuestion.category):(e="Waiting for the next question...",t=""),{mainMessage:e,subMessage:t}}}]),t}(a.a.Component),D=(n(40),function(e){function t(){return Object(I.a)(this,t),Object(B.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(k.a)(t,[{key:"leaveRoom",value:function(e){e?this.props.leaveRoom(e):this.props.viewLoginScreenAction()}},{key:"render",value:function(){var e=this;return a.a.createElement("nav",null,a.a.createElement("div",{className:"navInner"},a.a.createElement("div",{className:"navLeft"},a.a.createElement("button",{onClick:function(){return e.leaveRoom(e.props.roomKey)}},"Leave")),this.props.gameState===E.REGISTER?a.a.createElement("div",{className:"navMiddle"},a.a.createElement("h2",null,"RoomKey: ",this.props.roomKey)):a.a.createElement("div",{className:"navMiddle"},a.a.createElement("h2",null,"Question ",this.props.currentQuestionIndex+1),a.a.createElement("h2",null,"Round ",this.props.currentRound)),a.a.createElement("div",{className:"navRight"},a.a.createElement("span",null,this.props.teams.length," ",1===this.props.teams.length?"team":"teams"," connected"))))}}]),t}(a.a.Component));var M=s.b(function(e){return{gameState:e.game.gameState,roomKey:e.game.roomKey,currentQuestionIndex:e.game.currentQuestionIndex,currentRound:e.game.currentRound,teams:e.game.teams}},function(e){return{leaveRoom:function(t){return e(function(e){return function(t){fetch("".concat(d.API_URL,"/room/").concat(e),{method:"DELETE",credentials:"include"}).then(function(){var e=Object(m.a)(l.a.mark(function e(n){var r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:if(r=e.sent,!n.ok){e.next=8;break}t(v()),t({type:"team_leaveRoom"}),e.next=9;break;case 8:throw new Error(r.error);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log(e.message)})}}(t))},viewLoginScreenAction:function(){return e(v())}}})(D);var U=s.b(function(e){return{roomKey:e.game.roomKey,gameState:e.game.gameState,currentRound:e.game.currentRound,currentQuestionIndex:e.game.currentQuestionIndex,currentQuestion:e.game.currentQuestion,teams:e.game.teams,revealAnswer:e.game.revealAnswer}},function(e){return{joinRoom:function(t){return e(S(t))}}})(function(e){return a.a.createElement("div",{className:"Component Game"},a.a.createElement(M,null),a.a.createElement("main",null,a.a.createElement(K,{gameState:e.gameState,roomKey:e.roomKey,currentQuestion:e.currentQuestion,revealAnswer:e.revealAnswer}),a.a.createElement("div",{className:"teams"},e.teams.map(function(e){return a.a.createElement(Q,{key:e.teamName,text:"".concat(e.teamName),itemClass:"team"})}))))}),W=(n(41),function(e){function t(){return Object(I.a)(this,t),Object(B.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(k.a)(t,[{key:"getSortedTeams",value:function(){return this.props.teams.slice().sort(function(e,t){return e.score>t.score?-1:e.score<t.score?1:0})}},{key:"render",value:function(){return a.a.createElement("div",{className:"Component EndRound"},a.a.createElement(M,null),a.a.createElement("main",null,a.a.createElement("h1",{className:"endRoundMsg"},"End round ",this.props.currentRound),a.a.createElement("ul",null,this.getSortedTeams().map(function(e,t){return a.a.createElement("li",{key:t},a.a.createElement("span",{className:"position"},t+1,"."),a.a.createElement("span",null,e.teamName),a.a.createElement("span",{className:"score"},e.score," points"))}))))}}]),t}(a.a.Component));var V=s.b(function(e){return{roomKey:e.game.roomKey,currentRound:e.game.currentRound,teams:e.game.teams}},function(e){return{}})(W),z={activeView:T,messageScreenText:"If you see this, something went wrong!",wsAllowed:!1};var q=n(24),H={roomKey:null,gameState:null,currentRound:null,currentQuestionIndex:null,currentQuestion:null,teams:null,shotzTime:null,scores:null,revealAnswer:!1};var P=O.c({views:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z;switch((arguments.length>1?arguments[1]:void 0).type){case p.VIEW_LOGINSCREEN:return Object(x.a)({},e,{activeView:T,wsAllowed:!1});case p.VIEW_GAMESCREEN:return Object(x.a)({},e,{activeView:U,wsAllowed:!0});case p.VIEW_SCORESCREEN:return Object(x.a)({},e,{activeView:V,wsAllowed:!0});default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R.scoreB_setRoom:return Object(x.a)({},e,{roomKey:t.roomKey,gameState:t.gameState,currentRound:t.currentRound,currentQuestionIndex:t.currentQuestionIndex,teams:t.teams,revealAnswer:!1});case R.scoreB_nextQuestion:return Object(x.a)({},e,{currentQuestionIndex:t.currentQuestionIndex,currentQuestion:t.currentQuestion,gameState:E.IN_ROUND,revealAnswer:!1});case R.scoreB_setScores:return Object(x.a)({},e,{scores:t.scores,revealAnswer:!1});case R.scoreB_setTeams:return Object(x.a)({},e,{teams:t.teams});case R.scoreB_endGame:return Object(x.a)({},e,{teams:Object(q.a)(t.scores),gameState:E.END_GAME,revealAnswer:!1,roomKey:null});case R.scoreB_selecting_categories:return Object(x.a)({},e,{gameState:E.CATEGORY_SELECT});case R.scoreB_incCurRound:var n=e.currentRound.valueOf();return n++,Object(x.a)({},e,{currentRound:n});case R.scoreB_revealAnswer:return null===e.currentQuestion?e:Object(x.a)({},e,{revealAnswer:!0});default:return e}}});n.d(t,"store",function(){return F});var F=Object(O.d)(P,Object(O.a)(y.a)),J=a.a.createElement(s.a,{store:F},a.a.createElement(u,null));F.dispatch(function(){var e=Object(m.a)(l.a.mark(function e(t){var n,r,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={method:"GET",credentials:"include"},e.next=4,fetch("".concat(d.API_URL,"/room/restore/ROLE_SCOREBOARD"),n);case 4:return r=e.sent,e.next=7,r.json();case 7:if(a=e.sent,r.ok){e.next=10;break}throw new Error(a.error);case 10:t(b(a.roomKey,a.gameState,a.currentRound,a.currentQuestionIndex,a.teams)),t(g(a.gameState)),t(_()),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0.message);case 18:case"end":return e.stop()}},e,null,[[0,15]])}));return function(t){return e.apply(this,arguments)}}()),c.a.render(J,document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.2e0a0edd.chunk.js.map